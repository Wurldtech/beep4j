- verify call sequences on handler classes
  - for start type notifications, change state first, then notify handler
  - for end type notifications, first notify handler, then change state
  - ChannelHandler#channelCloseRequested is called a potentially a long time after 
    the CloseRequested state is attained; this could lead to problems (i.e. exceptions)
    when the application calls methods on Channel
    - solution 1: call ChannelHandler#channelCloseRequested immediately (i.e. before
                  all replies have been sent)
    - solution 2: an intermediate state that allows everything until the request is passed
                  to the handler

- consider decorator style implementation for filtering on Channel interface
  - first, the state must be considered
  - then the chain can be called
  - so the decorator must be based somehow on the state classes?

- create bidirectional echo profile
  - client connects to server
  - client opens channel
  - client sends an arbitrary number of echo requests (simply unstructured messages)
  - server echos the message back
  - and sends a request of its own on the same channel
  - client responds and for that message, the exchange is terminated
  - of course, the client can send as many requests on the same channel as it wants

- exception handling on client classes (handlers)
  - SessionHandler, ChannelHandler, and ReplyHandler
  - allow handlers to throw any exception?
  - catch exceptions and
    - terminate session?
    - delegate back to the handlers? e.g. ChannelHandler#exceptionCaught?

- CloseChannelCallback vs. Future
  - Channel#close(:CloseChannelCallback):void
  - Channel#close():Future<Boolean>
  - additionally, ChannelHandler#channelClosed() is called whenever a channel is closed

- synchronization
  - currently, all external access to the session is synchronized
  - however, beep4j calls application code (handlers) while still holding
    the session monitor
  - this could lead to deadlock (depending on how the application is programmed)
  
- Channel
  - add state to channel?
  - Channel#setAttribute(name,value)

- logging
  - add context: remote peer address, ...

- introduce thread pool to provide inter channel asynchrony
  - receiving messages
    - channel receives messages synchronously
    - channel receives replies synchronously
  
    while (true) {
      waitForPromotion()
      ChannelBuffer buf = fetchBuffer()
      giveUpLead()
      processEvents(buf)
      follow()
    }

- support Content-Transfer-Encoding: base64, (quoted-printable)

- GenericSessionHandler -> SessionHandler
  - factory:ChannelHandlerFactory
  - advertisedProfiles:String[]

  - connectionEstablished registers profiles
  - channelStartRequested selects first supported profile according to list
  
  - maybe desired, wait for user feedback

  
- logging
  - net.sf.beep4j.transport: logging of transport layer events
  - net.sf.beep4j.transport.DATA: all data passing through the transport layer


- 09.01.2007

  - filtering
    - review ChannelFilter interface
    - write LoggingChannelFilter, just for fun
  - logging
    - context (channel number, remote peer, ...)
    - low-level BEEP logging
 
  
  
  